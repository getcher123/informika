# Техническое задание — Фаза 3 (Informika)

## 1. Назначение и цели
- Публичная витрина результатов и активности: события, открытые кейсы, одобренные/архивные идеи (read-only).
- Базовая расширенная аналитика (дашборды + выгрузки CSV/Excel) без дублирования логики Bitrix24.
- Автоматизация коммуникаций с внешними участниками (события, рассылки) и прозрачные статусы для управленческой отчётности.

## 2. Область охвата

### Включено
1) Публичные страницы идей/кейсов (read-only) с минималистичными карточками, без действий по команде или модерации.  
2) Публичный календарь событий (онлайн/офлайн), регистрация на событие, рассылка напоминаний.  
3) Расширенная аналитика:
   - дашборды по воронке идей/запросов, направлениям, срокам;
   - выгрузки CSV/Excel (read-only) и быстрые отчёты (PDF/Excel) на данных портала + Bitrix24.  
4) Расширенные уведомления и подписки (топики: события, новые запросы, принятые решения).  
5) Публичный каталог команд/результатов (для одобренных/архивных идей) с ссылками на публичные материалы (презентации, демо).  
6) «Истории успеха» (статические страницы) с модерацией.  
7) Базовая стабилизация интеграций Bitrix24: кэширование справочников и ретраи при временных 50x.

### Исключено
- Управление командами и ролями: остаётся в Bitrix24 (портал отображает только текущий состав).
- Процедуры ПК/НТК и любые ведомственные согласования — только в Bitrix24.
- Внутренняя отчётность Bitrix24/кастомные отчёты внутри CRM — используем стандартные отчёты Bitrix24 и простые выгрузки; внешние BI-интеграции вне объёма.
- Разграничение по секретности/гостайне — вне объёма Ф3.

## 3. Роли и права (дополнения)
- Стейкхолдер: просматривает дашборды, публикует «Истории успеха», управляет событиями своих направлений.
- Координатор: управляет календарём событий, утверждает публичные материалы, запускает рассылки.
- Участник/Автор: может публиковать публичные материалы своей идеи (по разрешению координатора), регистрируется на события.
- Гость: регистрируется на события, читает публичные идеи/истории.

## 4. Жизненный цикл (дополнения Ф3)
- Для идеи в статусе «Архив» может быть создан «Кейс» (публичная карточка результата). Создание/публикация кейса не меняет статусы идеи и задач Bitrix24.
- Статусы кейса: Черновик → На модерации → Кейс → Архив (см. [statuses-table.md](statuses-table.md)).
- События: Черновик → Опубликовано → Завершено → Архив.
- Рассылки: Черновик → Запланирована → Отправлена → Завершена.

## 5. Функциональные блоки

### 5.1 Публичная витрина
- Каталог идей/кейсов (включая одобренные/архивные идеи и опубликованные кейсы) с фильтрами по направлению, типу и статусу: **Идеи** (`Одобрена`, `Архив`), **Кейсы** (`Кейс`, `Архив`).  
- Карточка публичной идеи: направление, статус, дата «Опубликовано/Обновлено», команда (текущий состав), краткое описание, материалы (презентация/видео/ссылка на демо), кнопка «Подробнее». Без кнопок управления командой или статусов.  
- Раздел «Истории успеха»: статические страницы с датой публикации; теги/конструктор не используются, публикацию модерирует координатор.
- Дополнительные страницы (см. interface-elements.md, разд. 14): публичный каталог кейсов (грид карточек с фильтрами по статусу и направлению), страница кейса (read-only) с блоками «Описание», «Кратко о результате», «Материалы», «Команда» и кнопкой «Перейти».

#### 5.1.1 Сущность «Кейс» (публичная карточка результата)

- **Назначение:** публичная витрина результата по завершённой идее/проекту; кейс доступен гостям в режиме read‑only и используется для PR/демонстраций.
- **Источник:** создаётся только для идеи в статусе `Архив` (или для записи «Проект», созданной при архивации), с привязкой к исходной идее и ссылками на материалы/Bitrix24.
- **Публичность:** гостю доступен только кейс в статусе `Кейс`. Статусы `Черновик`, `На модерации`, `Архив` — только авторизованным ролям (координатор/стейкхолдер).
- **Статусы и переходы:**
  - `Черновик` → `На модерации` (кнопка `Отправить на модерацию`).
  - `На модерации` → `Кейс` (кнопка `Опубликовать`, обязательна проверка материалов).
  - `Кейс` → `Архив` (кнопка `Снять с публикации`, фиксируется причина).
  - `Архив` → `Кейс` (повторная публикация по решению координатора/стейкхолдера).
- **Обязательные поля (минимум):** название, направление, краткое описание результата, блок «Материалы» (минимум 1 ссылка), ссылка на исходную идею/проект.
- **Команда в кейсе:** отображается текущий состав команды (read‑only, данные из Bitrix24/портала); публичность персональных данных определяется политикой (в Ф3 по умолчанию — ФИО + роль для авторизованных, для гостя — роль + инициалы/маска при необходимости).
- **Действия по ролям:**
  - Координатор: создаёт/редактирует кейс, отправляет на модерацию, публикует/снимает, управляет видимостью материалов.
  - Стейкхолдер: публикует/снимает кейсы своих направлений, утверждает материалы, может инициировать правки.
  - Участник/Автор: предлагает материалы (ссылки/файлы) для кейса через карточку идеи/Bitrix24; напрямую не публикует без разрешения координатора.

### 5.2 События
- Календарь обязателен: вид «месяц/неделя» + список; фильтры направление, формат (Онлайн/Офлайн), статус (Будущие/Прошедшие).
- Карточка события: дата/время, формат, место/ссылка, спикеры, материалы после события (одна ссылка/кнопка). Кнопки: «Зарегистрироваться», «Добавить в календарь (ics)», после завершения — «Материалы».
- Страница события: краткое описание, программа, спикеры, блок «Материалы» (после завершения), минимальная форма регистрации (ФИО, e-mail, роль) с подтверждением и уведомлением.
- Уведомления: подтверждение регистрации, напоминание за 24/2 часа, пост-фактум с материалами.


### 5.3 Аналитика и отчётность
- Дашборды: 3–4 виджета (воронка идеи → одобрена → архив; по направлениям; средние сроки модерации; активность событий) + админ‑панель с отчётами по активности пользователей и событий.
- Экспорт: ручные выгрузки CSV/Excel (по текущим фильтрам) и PDF/Excel отчёт для руководства (воронка, активность, топ-направления).
- Источник данных: кэшированные данные Bitrix24 (статусы задач, состав команд) и портала (идеи, события); без внешних BI-коннекторов.

### 5.4 Уведомления и подписки
- Подписки на: новые запросы, новые одобренные идеи, события по направлению, решения стейкхолдера.
- Канал: внутренняя лента портала + e-mail (если настроено), в карточках уведомлений — одна кнопка «Перейти».
- Фильтры уведомлений в ЛК: по типу (Идеи/Запросы/События/Системные), по прочитанности. Счётчик непрочитанных, история уведомлений, еженедельный дайджест.
- В ЛК добавляется вкладка «События и подписки»: простой список «Мои регистрации» (Дата/Название/Статус/кнопки `Перейти`/`Материалы`) и чекбоксы подписок (темы и каналы).

### 5.5 Интеграции и надёжность
- Bitrix24: кэширование справочников направлений/проектов, ретраи при временных 50x.
- Почта/SMTP: очередь писем, лог отправок.
- Логи интеграций: краткий файл логов ошибок, доступ координатору.

### 5.6 Профили (навыки, интересы, участие в проектах)
- Расширенные поля профиля: навыки (теги), интересы (направления/темы), участие в проектах (список кейсов с ролями).
- Поиск и фильтры по профилям: поиск по имени, навыкам, интересам; фильтр по роли/участию в проектах; выдача — карточки профилей с краткой информацией и кнопкой «Подробнее».
- Отображение в профиле: блок «Навыки и интересы», блок «Участие в проектах» (список идей/кейсов с ролями), кнопка «Редактировать» для владельца.

### 5.7 Архивация идей (преобразование в проекты)
- Стейкхолдер может перевести одобренную идею в «Архив» (как завершённый проект): кнопка «Перенести в архив» в карточке одобренной идеи.
- При архивации фиксируется дата/причина, создаётся запись «Проект» (read-only карточка с итоговыми материалами/ссылками на Bitrix24).
- Архивные проекты отображаются в публичном каталоге кейсов со статусом «Архив» и доступом к итоговым материалам.

### 5.8 Календарь и напоминания (обязательный элемент)
- Календарь событий обязателен: вид «месяц/неделя» + список; фильтры направление/формат/статус.
- Напоминания: автоматические уведомления за 24/2 часа до начала события, ссылка на подключение/адрес, пост-анонс с материалами после события.
- Анонсы и ссылки: карточка события содержит ссылку на трансляцию или адрес офлайна, кнопку «Добавить в календарь (ics)» и ссылку на материалы после завершения.

## 6. UX/Интерфейс
- Базируется на принципах минималистичных карточек из Ф2: одна главная кнопка «Подробнее/Перейти», без индикаторов заполненности команды, только текущий состав и датированные бейджи («Опубликовано/Обновлено ДД.ММ.ГГГГ» или «Просрочено» для событий).
- Портфель идей стейкхолдера: карточки (одобренные/архивные) + блок фильтр-чипов, быстрые ссылки на материалы/Bitrix24.
- События: лёгкая форма регистрации (ФИО, e-mail, роль), подтверждение на экране + уведомление.

## 7. Данные и интеграции
- Новые сущности:
  - Case (id, idea_id/project_id, title, direction, summary, result, tags[], materials[], public_team[], status, created_at, published_at, updated_at, archived_at, archived_reason).
  - Event (id, title, datetime, format, location/link, speakers, tags, materials[], status, created_at, published_at, updated_at).
  - Subscription (user_id, topic, channel, created_at).
- Расширения к идее/проекту: флаг «доступно для кейса» (включает возможность создать кейс), ссылки на публичные материалы (links/files) без дублирования файлов.
- Хранилище материалов: ссылки на Bitrix24 Disk или внешние CDN (нет дублирования файлов).

## 8. Приёмочные критерии
1) Публичный каталог кейсов/«Историй успеха» доступен без авторизации: кейсы в статусе `Кейс` отображаются в каталоге и открываются в read‑only карточку; карточки показывают статус и дату «Опубликовано/Обновлено», без кнопок управления командой/решений.  
2) События: календарь/список, регистрация, напоминания, материалы после события работают; регистрация гостя фиксируется, кнопка ics/ссылка на трансляцию или адрес присутствуют.  
3) Дашборды и админ‑панель отображают кэшированные данные портала и Bitrix24 (3–4 виджета), ручные выгрузки CSV/Excel и PDF/Excel отчёты доступны; внешних BI-коннекторов нет.  
4) Уведомления имеют счётчик/историю/настройки подписок и дайджест; вкладка «События и подписки» содержит список регистраций.  
5) Расширенный профиль (навыки/интересы, участие в проектах) доступен для просмотра/редактирования, поиск/фильтры по профилям работают.
6) Кейс можно создать только из идеи/проекта в статусе `Архив`; опубликование переводит кейс в статус `Кейс`, снятие с публикации — в `Архив` с фиксацией причины; гостю недоступны кейсы в статусах `Черновик/На модерации/Архив`.

## 9. Зависимости и предпосылки
- Доступные REST API Bitrix24 для чтения задач/команд и скачивания файлов.
- Настроенный SMTP или почтовая шина для уведомлений.
- Внешний BI не требуется; используются внутренние дашборды и выгрузки CSV/Excel.

## 10. Версии и источники
- Основано на: [tech-spec-F1.md](tech-spec-F1.md), [tech-spec-F2.md](tech-spec-F2.md), [informika-extended-tz.md](informika-extended-tz.md), [README.md](README.md).
