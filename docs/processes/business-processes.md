# Бизнес-процессы платформы «Informika»

Документ описывает ключевые процессы платформы. Для каждого процесса указаны участники, опорные статусы и артефакты. Подробные требования к данным, интерфейсам и автоматизациям см. в ТЗ фаз: [tech-spec-F1.md](../specs/phases/tech-spec-F1.md), [tech-spec-F2.md](../specs/phases/tech-spec-F2.md), [tech-spec-F3.md](../specs/phases/tech-spec-F3.md), а также в документах: [interface-elements.md](../ui/interface-elements.md), [team-requests-mechanism.md](team-requests-mechanism.md), [automation-table.md](automation-table.md) и [notification-table.md](notification-table.md).

## 1. Публикация запроса стейкхолдером
- **Инициатор:** стейкхолдер.
- **Шаги:**
  1. Создание черновика запроса через форму на странице запроса: поля «Проблема», «Критерии», «Сроки», «Направление», прикрепление файлов.
  2. Публикация статуса «На сборе идей» (кнопка «Опубликовать» переводит запрос в активное состояние; кнопка «Подать идею» появляется в карточке для участников).
  3. Мониторинг карточки запроса в разделе «Мои запросы»: индикатор «+N» сигнализирует о новых идеях; стейкхолдер по необходимости редактирует или закрывает запрос кнопками «Редактировать запрос»/«Закрыть запрос».
  4. Автоматическое закрытие по дедлайну или ручной перевод в «Закрыт» (кнопка «Закрыть запрос»).
- **Артефакты:** карточка запроса, грид идей, журнал статусов, кнопки «Подать идею» и «Редактировать» на странице запроса.

## 2. Подача и модерация идеи
- **Инициаторы:** автор идеи, модератор, стейкхолдер.
- **Шаги:**
  1. Участник нажимает кнопку «Подать идею» на странице запроса и попадает на отдельную страницу создания (поля: Название, Описание, Ожидаемый эффект, Направление, вложения, чекбокс согласия).
  2. Сохранение черновика (кнопка «Сохранить черновик») или отправка модератору (кнопка «Отправить на модерацию») → статус «На модерации». Карточка идеи появляется в разделе «Мои идеи» и в гриде запроса.
  3. Модератор проверяет материалы:
     - Кнопка «Опубликовать» переводит в статус «На рассмотрении».
     - Кнопка «Вернуть на доработку» открывает модальное окно для причины и ставит статус «На доработке» (количество возвратов ограничено политикой).
     - Кнопка «Отклонить» завершает процесс.
  4. Автор вносит правки и повторно отправляет.
  5. Стейкхолдер в разделе «Мои запросы» просматривает идею и принимает решение:
     - Из карточки идеи (блок «Решение») доступны кнопки «Одобрить», «Отклонить», «Отправить на доработку» (последняя вызывает модальное окно с обязательной причиной).
     - Одобрение переводит идею в статус `Одобрена` и делает её доступной в «Портфеле идей» стейкхолдера; отклонение фиксирует решение и уведомляет автора.
- **Артефакты:** страница создания идеи, карточка идеи (с индикаторами комментариев и стадий), модальное окно возврата, журнал решений стейкхолдера.

## 3. Формирование команды идеи
- **Участники:** координатор, претенденты, стейкхолдер.
- **Шаги:**
  1. **Источник истины:** заявки, приглашения и фактическое включение в команду ведутся в Bitrix24 (CRM/смарт‑процесс `TeamRequest`). Портал — витрина статусов и состава команды.
  2. Участник нажимает `Вступить в команду` в карточке одобренной идеи и заполняет форму. На стороне Bitrix24 создаётся карточка `TeamRequest` типа `request` со стадией `На рассмотрении`.
  3. Координатор/стейкхолдер обрабатывает карточки `TeamRequest` в Bitrix24 по стадиям воронки (как типичная CRM, без фильтров):
     - `Принять` → стадия‑триггер `Одобрено / Отправить приглашение` → Bitrix24 отправляет e‑mail‑приглашение (BitrixInvite) и переводит в `Ожидает E-mail подтверждения`;
     - `Отклонить` → `Отклонена` (обязательна причина);
     - при необходимости создаётся `TeamRequest` типа `invitation` (приглашение конкретного человека): в Bitrix24 указывается e‑mail, система отправляет BitrixInvite и переводит в `Ожидает E-mail подтверждения`.
  4. Участник подтверждает приглашение из письма Bitrix24. Только после подтверждения Bitrix24 выдаёт доступ к рабочему пространству и переводит карточку в `В команде`.
  5. На портале:
     - список заявок виден карточками со статусами `На рассмотрении / Ожидает E-mail подтверждения / В команде / Отклонена / Архив`;
     - кнопок `Принять/Отклонить` нет (управление — в Bitrix24);
     - у автора заявки доступно действие `Отозвать` только в статусе `На рассмотрении`;
     - блок `Команда` показывает текущий состав (ФИО/роль) из Bitrix24.
- **Артефакты:** `TeamRequest` (CRM Bitrix24), e‑mail‑инвайт Bitrix24, витрина статусов в портале, блок `Команда` на странице идеи.

## 4. Перевод идеи в «Одобрена» и запуск рабочей области Bitrix24
- **Участники:** стейкхолдер, координатор, система интеграции.
- **Шаги:**
  1. Стейкхолдер выставляет статус «Одобрена».
  2. Автотриггер (см. [automation-table.md](automation-table.md)):
     - Создание канбан-доски `<ID идеи>` с колонками `Новая → В работе → На проверке → Возврат → Готово`.
     - Предзагрузка стартовых задач (Аналитика, План, Прототип, Тестирование, подготовка к комиссиям, Итоговый отчёт).
     - Развёртывание структуры папок `/Требования`, `/План`, `/Прототипы`, `/Тесты`, `/Отчёты`, `/Коммуникации`.
     - Добавление гайдов и шаблонов: `README-по-команде.md`, `task-guide.txt`, шаблон чек-листа, образцы документов.
  3. В карточке идеи появляются кнопки «Перейти к задачам», «Перейти к документам»; у стейкхолдера в «Портфеле идей» отображаются быстрые ссылки и индикаторы рисков (например, просроченные задачи).
  4. Рассылка приглашений участникам и стейкхолдеру, уведомление координатору, создание задач на административной доске.
- **Артефакты:** канбан-доска Bitrix24, структура Диска, кнопки переходов в интерфейсе, административная карточка «Настроить рабочую область».

## 5. Исполнение и сопровождение идеи (Фаза 2)
- **Участники:** команда идеи, координатор, стейкхолдер, эксперты/менторы/трекеры.
- **Шаги:**
  1. Работа по задачам в канбан-доске (кнопка «Перейти к задачам» из карточки идеи): исполнители двигают задачи по колонкам, отмечают чек-листы, прикладывают файлы.
  2. Управление документами через кнопку «Перейти к документам»/Диск идеи (структура `/Требования`, `/План`, `/Прототипы`, `/Тесты`, `/Отчёты`, `/Коммуникации`).
  3. Координатор отслеживает индикаторы просрочки, обновляет отчёты в папке `/Отчёты`, использует административную доску для контрольных задач (например, «Освободилась обязательная роль»).
  4. Эксперты/менторы оставляют комментарии во вкладке «Комментарии» страницы идеи и в задачах Bitrix24.
  5. Стейкхолдер и участники получают уведомления (вкладка «Уведомления» в ЛК) о решениях и обновлениях.
- **Артефакты:** карточки задач в Bitrix24, кнопки переходов, структура Диска, административная канбан-доска, вкладки «Комментарии» и «Уведомления».

## 6. Подготовка к ПК/НТК и финализация
- **Участники:** координатор, стейкхолдер, команда.
- **Шаги:**
  1. Координатор использует чек-лист готовности (описан в `role-checklists.md`) и отмечает выполнение пунктов в административной карточке Bitrix24.
  2. Документы загружаются на Диск Bitrix24; статусы готовности фиксируются исключительно в задачах/чек-листах (без бейджей в кабинете).
  3. Стейкхолдер проверяет материалы через кнопки «Перейти к документам» и подтверждает готовность внутри Bitrix24.
  4. Проведение комиссий (ПК/НТК) фиксируется в комментариях административных задач Bitrix24.
- **Артефакты:** чек-листы готовности, задачи административной доски и документы Bitrix24; витрина платформы не содержит отдельных стадий «Готово к ПК/НТК».

## 7. Перевод в «Архив» и отчётность
- **Участники:** стейкхолдер, координатор, система уведомлений.
- **Шаги:**
  1. Стейкхолдер инициирует `Архивировать` и указывает сопроводительное сообщение (почему проект завершён, что получилось, ссылка на материалы/отчёты).
  2. В Bitrix24 идея переводится в статус `Архив` (см. [statuses-table.md](../ui/statuses-table.md)), рабочая область закрывается согласно регламенту доступа.
  3. Команда получает уведомления, незавершённые задачи доводятся до финального статуса/закрываются по правилам программы.
  4. Актуализируются итоговые материалы: отчёт, презентация, финальные документы на Диске.
- **Артефакты:** карточка идеи в статусе `Архив`, сопроводительное сообщение стейкхолдера, финальный пакет материалов, ссылки на Bitrix24.

## 8. Создание и публикация кейса (Фаза 3)
- **Участники:** стейкхолдер (владелец публикации), координатор (помощь), команда.
- **Принцип:** кейс не создаётся автоматически. После архивации в карточке проекта появляется действие `Создать кейс` (видит стейкхолдер).
- **Шаги:**
  1. Стейкхолдер нажимает `Создать кейс` и заполняет форму публикации (`case-form.html`): название, направление, **опционально** ссылка на идею (URL), краткое описание, блоки «проблема/цель/что сделали/итог», опциональные показатели результата (значение + описание), загрузка материалов, состав команды (ФИО/роль/должность).
  2. Кейс сохраняется как `Черновик` и доступен только внутри кабинетов/ролей (не в публичной витрине).
  3. Стейкхолдер публикует кейс (`Опубликовать`) → кейс становится видимым гостям и попадает в публичную ленту `Кейсы` (`cases.html`).
  4. При необходимости стейкхолдер снимает кейс с публикации (`Снять с публикации`) — причина указывается во всплывающем окне; кейс исчезает из публичной витрины.
- **Артефакты:** карточка кейса (статусы публикации `Черновик/Опубликовано/Снято с публикации`), публичная страница `case-public.html`, материалы (список документов), блок `Команда кейса`, опциональная ссылка на идею (в публичной карточке отображается в правой панели как `Внешняя ссылка`).

## 9. Публичные кейсы (Фаза 3)
- **Участники:** гость/авторизованный пользователь (просмотр).
- **Шаги:**
  1. Пользователь открывает страницу `Кейсы` (`cases.html`) (лента опубликованных кейсов).
  2. Применяет фильтры `Направление`, `Сортировка`, `Поиск`.
  3. Открывает кейс из карточки → `case-public.html`.
- **Артефакты:** лента кейсов, карточка кейса (бейдж направления + `Опубликовано ДД.ММ` + кнопка `Открыть`), публичная карточка кейса (read‑only).

## 10. Календарь мероприятий и управление событиями (Фаза 3)
- **Участники:** стейкхолдер/координатор (создание и управление), гость (просмотр), участник (регистрация).
- **Шаги:**
  1. Организатор создаёт мероприятие через форму `Создание события` (тип, формат, описание, программа, дата/время, ссылка/место, спикеры, материалы).
  2. Публикация: событие попадает в публичный календарь и ленты; на карточках в ленте доступна только кнопка `Подробнее`.
  3. Отмена: организатор выполняет `Отменить событие` (причина указывается в модальном окне). В публичных списках событие помечается как `Отменено`.
  4. Архивация: после отмены или завершения событие может быть `Архивировано` (скрывается из публичных списков по правилам хранения).
- **Артефакты:** `events.html` (вкладки календарь/ленты), `event-detail.html` (детальная страница), форма `event-form.html`, страница управления стейкхолдера `stakeholder-events.html` и `stakeholder-event-edit.html`.

## 11. Регистрация на мероприятие (Фаза 3)
- **Участники:** участник (регистрация/отмена), система уведомлений.
- **Шаги:**
  1. Пользователь открывает `event-detail.html` и нажимает `Зарегистрироваться`.
  2. Если пользователь не авторизован, регистрация недоступна (поясняющий текст + переход к авторизации).
  3. После регистрации пользователь видит запись в ЛК `События` и может `Отменить регистрацию` или перейти в детали (`Подробнее`).
  4. На странице события (`event-detail.html`) доступна кнопка `Добавить в календарь` (скачивание `.ics`) для будущих мероприятий, которые не отменены.
- **Артефакты:** запись регистрации, `participant-events.html` (таблица регистраций), `.ics` файл, уведомления (см. [notification-table.md](notification-table.md)).

## 12. Поддерживающие процессы
- **Уведомления:** согласно [notification-table.md](notification-table.md) (статусы, заявки, задачи, документы).
- **Отчётность:** см. [report-table.md](../analytics/report-table.md) (перечень отчётов по ролям).
- **Чек-листы:** см. [role-checklists.md](role-checklists.md) (контроль выполнения ролями).
- **Матрица доступа:** см. [access-matrix.md](access-matrix.md) (распределение прав).
- **Статусы:** см. [statuses-table.md](../ui/statuses-table.md) (жизненный цикл сущностей).
- **Поддержка и служебные страницы (публично):**
  - обращение в поддержку (`support-form.html`) — отправка письма на `info@ukkmosoblgaz.ru` с данными обращения;
  - восстановление пароля (`password-restore.html` → письмо → `password-reset.html`);
  - подтверждение регистрации по e‑mail (шаблон письма `email-confirm-registration.html`).

## 13. Диаграмма высокого уровня (текстовое описание)
1. **Идея стейкхолдера → запрос** (создание, публикация).
2. **Идея участника → модерация → решение стейкхолдера** (одобрение, доработка с причиной или отклонение).
3. **Одобрена → команда → Bitrix24** (формирование команды, запуск рабочей области).
4. **Исполнение → Архив** (управление задачами, финализация; готовность к ПК/НТК подтверждается в Bitrix24).
5. **Архив → (опционально) Кейс → Публичная витрина** (создание кейса, публикация, показ на странице `Кейсы`).
6. **События → календарь → регистрация** (создание/публикация/отмена/архив; регистрация участника и .ics).

Каждый из блоков сопровождается автоматизациями и уведомлениями, обеспечивающими прозрачность и контроль сроков на всех этапах.
