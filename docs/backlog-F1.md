# Бэклог задач — Фаза 1 (MVP «Запросы и Идеи»)

Ниже перечислены задачи для реализации Ф1. Каждая оформлена по шаблону `.github/ISSUE_TEMPLATE/feature.md`.

## Задача 1: Глобальная навигация и состояние профиля

### Контекст/Зачем
Единый хедер и индикация авторизации обеспечивают консистентную навигацию и доступ к «Личному кабинету».

### Acceptance Criteria (AC)
- [ ] В хедере отображаются пункты: «МЕДИАЦЕНТР», «ПРОЕКТНАЯ БИРЖА», «КОНКУРС», «ОБУЧЕНИЕ», «ВОЙТИ/ПРОФИЛЬ».
- [ ] При авторизации «ВОЙТИ» заменяется на иконку аватара с меню: «Личный кабинет», «Выйти».
- [ ] Активный пункт меню подсвечивается.
- [ ] Навигация доступна на всех публичных и авторизованных страницах.

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Есть скриншоты состояния хедера (гость/авторизован)
- [ ] Обновлена документация (маршрутизатор, точки входа)

## Задача 2: Главная страница (публичная витрина) — макет 4.1

### Контекст/Зачем
Публичная витрина платформы с ключевыми блоками и CTA по макету 4.1. CTA ведут в соответствующие разделы; не реализованные в Ф1 — через заглушки.

### Acceptance Criteria (AC)
- [ ] Заголовок с описанием акселератора.
- [ ] Информационные метрики (например: «40+», «15+») отображаются статично/из источника данных.
- [ ] CTA-кнопки: «Смотреть проекты», «Участвовать в конкурсах» — ведут в соответствующие разделы.
- [ ] Блок «Экосистема успеха»: 4 карточки (Партнерство, Продвижение, Сообщество, Финансирование) — заголовок + краткий текст.
- [ ] Блок «Как принять участие?»: 2 карточки с кнопками «Стать частью команды», «Подать заявку».
- [ ] Секция «Наши партнеры» с логотипами (адаптивная сетка, alt‑тексты).
- [ ] Промо-блок с CTA «Стать участником» (ведёт на регистрацию/вход).
- [ ] Ссылки на разделы, не реализованные в Ф1, открывают заглушку (stub) с текстом «Функциональность доступна в следующих фазах» и кнопкой «Вернуться на главную».

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Скриншоты/видео всех блоков и переходов по CTA (включая заглушки)
- [ ] Обновлена документация (сопоставление CTA → маршруты/заглушки, источники данных метрик)

## Задача 3: Каталог запросов (список, фильтры, сортировки, поиск)

### Контекст/Зачем
Позволяет участникам находить релевантные запросы; критично для конверсии подачи идей.

### Acceptance Criteria (AC)
- [ ] Поиск по названию/описанию запросов (полнотекстовый/LIKE согласно платформе).
- [ ] Фильтры-чипсы: Все / На сборе идей / Закрыт + «Сбросить».
- [ ] Фильтр по направлению: Строительство / Эксплуатация / Безопасность / Цифровизация / Клиентский сервис / Другое.
- [ ] Сортировка: По новизне / По дедлайну (возр./убыв.).
- [ ] Карточка запроса в списке: направление, статус, название, аннотация, дедлайн, владелец, «Подробнее».

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Тест-кейсы работы фильтров/поиска/сортировок
- [ ] Обновлена документация (параметры API/запросов)

## Задача 4: Форма создания/редактирования запроса (стейкхолдер)

### Контекст/Зачем
Стейкхолдеру нужен интерфейс для создания и публикации запросов на инновации.

### Acceptance Criteria (AC)
- [ ] Поля: название*, проблема/цель*, критерии принятия*, дедлайн*, направление*, вложения (PDF/DOCX/XLSX ≤ 10 МБ), теги.
- [ ] Валидации: обязательность, формат даты, ограничение по размеру/типу файлов.
- [ ] Действия: «Сохранить черновик», «Опубликовать», «Закрыть сбор» (после публикации), «Удалить» (только черновик).
- [ ] Статусы: Черновик → На сборе идей → Закрыт (вручную/по дедлайну).
- [ ] Лог изменений фиксируется (кто/когда/что).

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Скриншоты форм и сообщений валидации
- [ ] Обновлена документация (схема данных «Requests»)

## Задача 5: Карточка запроса (страница)

### Контекст/Зачем
Подробная страница запроса с условиями, вложениями и кнопкой «Подать идею» для авторизованных.

### Acceptance Criteria (AC)
- [ ] Отображаются: направление, статус, заголовок, владелец, проблема/цель, критерии, сроки (публикация/дедлайн), вложения (имя/тип/размер), теги.
- [ ] Кнопка «Подать идею» видна только в статусе «На сборе идей» и авторизованным участникам.
- [ ] Счётчик «Подано идей: N» обновляется при новых отправках.
- [ ] Для владельца: «Изменить», «Закрыть сбор» доступны по статусу.

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Скриншоты состояний (гость/автор/владелец)
- [ ] Обновлена документация (маршрутизация/guard’ы)

## Задача 6: Форма подачи идеи (черновик/отправка)

### Контекст/Зачем
Участник подаёт идеи на активные запросы; нужны черновики и строгие валидации.

### Acceptance Criteria (AC)
- [ ] Поля: Заголовок* (≤100), Краткое описание* (≤1000), Ожидаемый эффект (опц.), Вложения (PDF/DOCX/XLSX ≤10 МБ), Направление (наследуется/редактируемо опц.), согласие ПДн (если требуется).
- [ ] Действия: «Сохранить черновик», «Отправить», «Отмена».
- [ ] Антидубликат: запрет одинакового заголовка в рамках одного запроса (чувствительность к регистру оговорена).
- [ ] Ошибки валидации отображаются инлайн у соответствующих полей.

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Видео сценария «черновик → отправка»
- [ ] Обновлена документация (схема «Ideas», правила дубликатов)

## Задача 7: Карточка идеи (детали, история, комментарии, действия по ролям)

### Контекст/Зачем
Прозрачная модерация и принятие решений требуют истории изменений и ленты комментариев.

### Acceptance Criteria (AC)
- [ ] Отображаются: направление, статус, заголовок, привязка к запросу, автор, описание, эффект, вложения.
- [ ] История изменений: вехи статусов с автором и временем, комментарии модерации.
- [ ] Комментарии: лента (автор/роль/время/текст), форма добавления (участник, модератор, стейкхолдер).
- [ ] Действия по ролям: Автор — «Редактировать» (черновик/на доработке), «Отправить повторно»; Модератор — «Опубликовать/Принять к рассмотрению», «Вернуть на доработку» (с причинами), «Отклонить»; Стейкхолдер — «Принять/Отклонить» (с комментарием) после модерации.

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Скриншоты/видео с действиями по ролям
- [ ] Обновлена документация (матрица прав на действия)

## Задача 8: Личный кабинет — вкладка «Мои заявки» (общая для участника/стейкхолдера)

### Контекст/Зачем
Единый центр управления идеями (автора) и запросами (владельца) с фильтрами и быстрыми действиями.

### Acceptance Criteria (AC)
- [ ] Табы: «Мои заявки» (активен) / «Профиль».
- [ ] Поиск по заявкам.
- [ ] Переключатель «Тип»: Идеи / Запросы (если доступны оба).
- [ ] Фильтры-чипсы (Идеи): Все / Черновики / На модерации / На доработке / Принятые / Отклонённые + «Сбросить».
- [ ] Фильтры-чипсы (Запросы): Все / Черновики / На сборе идей / Закрыт + «Сбросить».
- [ ] Карточка идеи: направление, статус, название, краткое описание, «Ваша роль: Автор», «Подробнее», «Редактировать» по статусу.
- [ ] Карточка запроса: направление, статус, название, краткое описание, «Ваша роль: Владелец запроса», дедлайн, «Подробнее», «Изменить», «Закрыть сбор» по статусу.

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Скриншоты/видео переключения типов и фильтров
- [ ] Обновлена документация (страница ЛК, параметры списка)

## Задача 9: Личный кабинет — вкладка «Профиль»

### Контекст/Зачем
Пользователь управляет своим профилем и безопасностью (смена пароля).

### Acceptance Criteria (AC)
- [ ] Шапка: аватар (загрузка), ФИО, организация/подразделение/должность, теги ролей (#работник_Мособлгаза, #стейкхолдер и др.), кнопка «Редактировать».
- [ ] Контакты: Дата рождения, Телефон, E‑mail — редактируемые поля с валидацией (телефон +7, e‑mail формат).
- [ ] Смена пароля: текущий, новый, повтор нового — проверка длины ≥8 и совпадения.
- [ ] Успешные изменения подтверждаются уведомлением; ошибки подсвечиваются у полей.

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Скриншоты форм и валидаций
- [ ] Обновлена документация (модель профиля)

## Задача 10: Панель модерации (запросы/идеи)

### Контекст/Зачем
Модератору необходим общий интерфейс очереди с быстрым переходом к карточке модерации.

### Acceptance Criteria (AC)
- [ ] Табы «Запросы» / «Идеи» в панели модерации.
- [ ] Фильтры-чипсы: На модерации / Возврат на доработку / Все + «Сбросить».
- [ ] Список карточек: тип, заголовок, автор/владелец, дата, статус, «Подробнее».
- [ ] Карточка модерации: предпросмотр содержимого/вложений; правая колонка действий «Опубликовать», «Вернуть на доработку» (обязательное поле «Причины»), «Отклонить» (обоснование).

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Видео модерации запроса и идеи
- [ ] Обновлена документация (роли и переходы)

## Задача 11: Аутентификация и регистрация (шаг 1 и шаг 2)

### Контекст/Зачем
Доступ к подаче идей и управлению запросами возможен только для авторизованных пользователей.

### Acceptance Criteria (AC)
- [ ] Страница входа: поля «E‑mail или телефон», «Пароль»; ссылка «Восстановить пароль»; кнопка «Войти».
- [ ] Регистрация — шаг 1: Фамилия*, Имя*, Отчество (опц.), Телефон* (+7), E‑mail*, Пароль* (≥8), Повтор пароля*; чекбокс согласий.
- [ ] Регистрация — шаг 2: роль (Работник МОГ / Представитель учебного заведения / Представитель бизнеса / Студент / Гость). В Ф1 особые права — для Участника и Стейкхолдера.
- [ ] После регистрации доступна подача идеи; для стейкхолдера — создание запросов.

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Видео прохождения регистрации (оба шага)
- [ ] Обновлена документация (правила доступа)

## Задача 12: Уведомления по ключевым событиям

### Контекст/Зачем
Своевременная коммуникация повышает вовлеченность и прозрачность процессов.

### Acceptance Criteria (AC)
- [ ] E‑mail/внутренние уведомления: новый запрос, подача идеи, возврат на доработку, принятие/отклонение идеи.
- [ ] Напоминание за N дней до дедлайна активных запросов владельцу (опц.).
- [ ] Настройки SMTP/отправки вынесены в конфигурацию.

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Скриншоты/дампы писем или логов уведомлений
- [ ] Обновлена документация (матрица событий → уведомлений)

## Задача 13: Автоматическое закрытие запросов по дедлайну

### Контекст/Зачем
Исключает приём идей после дедлайна и поддерживает корректные статусы.

### Acceptance Criteria (AC)
- [ ] Планировщик/крон переводит запросы со статусом «На сборе идей» в «Закрыт» по истечении дедлайна.
- [ ] Кнопка «Подать идею» скрыта для закрытых запросов.
- [ ] Событие закрытия логируется; при необходимости отправляется уведомление владельцу.

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Тест-кейс с искусственным дедлайном
- [ ] Обновлена документация (служба планировщика)

## Задача 14: Загрузка и хранение файлов (вложения)

### Контекст/Зачем
Поддержка вложений для запросов и идей согласно ограничениям Ф1.

### Acceptance Criteria (AC)
- [ ] Поддерживаются форматы PDF/DOCX/XLSX, размер ≤ 10 МБ (каждый файл).
- [ ] Отображение списка вложений: имя, тип, размер; загрузка/удаление в формах.
- [ ] Проверка и обработка ошибок загрузки (тип/размер/ошибка сети).
- [ ] Доступ к файлам ограничен правами (черновики недоступны публично).

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Скриншоты/видео сценариев загрузки
- [ ] Обновлена документация (политика хранения/права)

## Задача 15: Поиск/индексация и фильтрация данных

### Контекст/Зачем
Производительность и релевантность выдачи в каталогах Ф1.

### Acceptance Criteria (AC)
- [ ] Реализована индексация/поиск по названию и описанию запросов.
- [ ] Фильтры и сортировки работают совместно (комбинация параметров).
- [ ] Пагинация в списках (настройка размера страницы).

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Тест-кейсы поиска/фильтров/сортировок/пагинации
- [ ] Обновлена документация (UX и API параметров)

## Задача 16: Миграции/инициализация данных (справочники и демо)

### Контекст/Зачем
Быстрый запуск стенда с предзаполненными сущностями для демонстрации и тестирования.

### Acceptance Criteria (AC)
- [ ] Справочник направлений (6 значений) создаётся автоматически.
- [ ] Созданы тестовые пользователи: стейкхолдер, модератор, 2 участника.
- [ ] Предзаполнены 3 запроса (2 активных, 1 закрыт) и 5 идей.

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Скриншоты/дамп БД/скрипт миграции
- [ ] Обновлена документация (инструкции запуска демо)

## Задача 17: Разграничение доступа и видимость действий/статусов

### Контекст/Зачем
Корректные права и скрытие недоступных действий предотвращают ошибки и утечки данных.

### Acceptance Criteria (AC)
- [ ] Роли: гость, участник, стейкхолдер, модератор — настроены согласно матрице.
- [ ] Недоступные действия скрываются из UI; попытки через прямые ссылки блокируются.
- [ ] Видимость статусов/кнопок соответствует роли и состоянию сущности.

### Definition of Done (DoD)
- [ ] Пройдено локально: fmt/lint/phpstan
- [ ] Тест-кейсы по каждому профилю роли
- [ ] Обновлена документация (матрица прав/видимости)

---
Источник требований: docs/tech-spec-F1.md и docs/informika-extended-tz.md.
