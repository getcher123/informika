# Архитектура проекта

## Модель данных (CRM)

### Смарт‑процесс «Запрос»

- Поля: Название, Владелец/подразделение, Описание, Критерии отбора, Дедлайн приёма идей, Роли (куратор/эксперты/стейкхолдеры), Видимость, Статус/Степень приоритета.

### Смарт‑процесс «Идея»

- Поля: Название, Описание, Автор, Привязка к «Запросу», Статус (Новая/На уточнении/На оценке/Комиссия/Принята/Отклонена/В резерв), Ориент. бюджет/эффект, Ссылки на Проект/ключевую Задачу (ID), «Официальный ответ».

### Проект (реализация)

- Типовая Рабочая группа (Проект) + Задачи/Канбан, Диск (папки проекта), Чат проекта.
- В «Идее» храним обратные ссылки (ID группы/задач).

### Участники/коммуникации/мероприятия

- Профили пользователей (с доп. полями Роль/Навыки), чаты/упоминания. События программы — Календарь.

## Воронки и стадии

### Запрос

- Черновик → Публикация → Сбор идей → Отбор/Комиссия → Закрыт.

### Идея

- Новая → На уточнении → На оценке (эксперты) → Комиссия → Принята / Отклонена / В резерв → Внедрена.

## Роботы и триггеры

### Запрос (роботы на стадии)

- Публикация: уведомить кураторов/экспертов/заинтересованных (IM+email), закрепить карточку в чате подразделения, поставить SLA‑таймер «закрытие приема».
- Сбор идей: автоподписка ролей на новые «Идеи» по этому «Запросу», напоминание за N дней до дедлайна.
- Закрыт: рассылка авто‑итогов (сколько идей/принято/в работу), уведомить авторов непринятых.

### Идея (роботы на стадии)

- Новая → На уточнении: создать задачу автору/модератору «Уточнить идею» (чек‑лист), назначить куратора, поставить SLA (эскалация руководителю при просрочке), уведомить экспертов.
- На оценке: сгенерировать задания экспертам (задачи/активности) с полями «оценка по критериям», дождаться всех оценок, рассчитать интегральный балл, авто‑сортировка на Комиссию.
- Комиссия: сформировать пакет (PDF/линки) из карточки Идеи + оценок, уведомить членов комиссии, зафиксировать «Официальный ответ» (прикреплённая активность в таймлайне).
- Принята → Проект: робот «Запрос к REST/Webhook» вызывает backend‑скрипт, который:
  - создаёт Рабочую группу (Проект),
  - разворачивает шаблон задач (эпик + подзадачи),
  - готовит структуру Диска (копирует шаблоны документов),
  - создаёт чат проекта и добавляет участников (автор, куратор, команда),
  - возвращает IDs; робот записывает их в поля «Идеи», двигает стадию «Внедрение», шлёт авто‑нотификации автору/стейкхолдерам.
- Отклонена/В резерв: отправить автору мотивированный «официальный ответ», предложить альтернативные запросы; метка «в резерв до <дата>».

## Проект (роботы в Задачах/Канбан)

- На старте проекта: автогенерация подзадач по шаблону (оценка, бюджет, риски, пилот), назначение ответственностей и чек‑листов.
- По стадиям: напоминания перед дедлайнами, автопереназначение при неактивности, авто‑перевод эпика при закрытии ключевых подзадач, сбор артефактов в финальную папку.
- На завершении: задача «Ретроспектива/результаты», робот возвращает статус в «Идею» → «Внедрена», публикует короткий отчёт в канал «Инновации».

## Обсуждения и «официальный ответ»

- Все диалоги — таймлайн Смарт‑процесса «Идея» (комментарии с @упоминаниями) + автосоздаваемый чат проекта после принятия.
- «Официальный ответ» — закреплённая активность/комментарий в карточке «Идеи»; хранится и виден автору и ролям.

## Ввод идей/заявок

- CRM‑форма для «Идеи» (внутренняя: открывается с предзаполненным полем «Запрос»; внешняя — при необходимости сбора от внешних участников).
- Быстрые кнопки: «Подать идею» на портале → слайдер‑форма Смарт‑процесса.
- Импорт/интеграции: входящий webhook из сайта/Miro/Trello создаёт «Идею» в нужной воронке.

## Права и прозрачность

- Роли на уровне Смарт‑процессов: Стейкхолдеры/Кураторы (чтение/решения), Модераторы (редактирование/перевод стадий), Эксперты (доступ к оценке), Участники (видят свои идеи и публичные).
- Публичность управляется полем «Видимость» + правами в воронках; внешние участники — через Экстранет только в проект после принятия.

## Аналитика и коммуникации

- CRM‑аналитика по двум смарт‑процессам: воронки, конверсия «Идея → Проект», SLA уточнений/оценок, вклад подразделений, топ‑идеи по баллам/эффекту.
- Дайджест недели (агент/крон): новые запросы/идеи/принятые/запущенные проекты + ближайшие мероприятия; рассылка по ролям и пост в общий канал.

## UX и раздел «Инновации»

- Главная: виджеты «Открытые запросы», «Топ‑идеи», «Сейчас на комиссии», «Запущено проектов», CTA «Подать идею/Создать запрос».
- Канбан по «Запросам» и «Идеям» с быстрыми действиями (перевод стадий, запуск роботов, пин «официального ответа»).
- В карточке «Идеи»: ссылки на Запрос/Проект/ключевую Задачу, оценки экспертов, история решений, кнопка «Создать проект» (fallback на ручной запуск робота).

## Внедрение по этапам

- Этап 1 (MVP): Смарт‑процессы «Запрос» и «Идея», базовые стадии, роботы уведомлений/уточнений/оценок, CRM‑форма «Подать идею», базовые отчеты.
- Этап 2: Webhook «Идея → Проект», шаблоны проектов/задач/папок, автоссылки, чаты проектов, канбан‑автоматика задач.
- Этап 3: Дайджест/агент, расширенная аналитика (SLA/конверсия/эффект), брендированные виджеты раздела «Инновации», внешние интеграции (если нужны).
