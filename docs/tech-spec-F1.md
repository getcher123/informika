# Техническое задание — Фаза 1 (MVP «Запросы и Идеи»)

## 1. Цель и границы
- Цель: запустить базовый цикл «стейкхолдер публикует запрос → участники подают идеи → модерация → подтверждение/отклонение». Публичные защиты и этап внедрения — вне Ф1.
- Включено: база запросов, база идей, роли (стейкхолдер, участник, модератор, гость), регистрация/вход, минимальная витрина/навигация, уведомления по ключевым событиям, базовые фильтры/поиск, загрузка вложений.
- Исключено: дальнейшая работа по внедрению (Bitrix), сложная аналитика/отчётность, события/календарь, расширенные роли (трекер/ментор/эксперт) — переносятся на Ф2–Ф3.

## 2. Роли и права (минимум Ф1)
- Стейкхолдер:
  - Создание/публикация запросов на инновации.
  - Просмотр и фильтрация идей по своим запросам, комментарии, принятие/отклонение идей.
- Участник:
  - Просмотр каталога запросов, подача идеи на конкретный запрос, просмотр статуса своей идеи, переписка в комментариях.
- Модератор:
  - Премодерация контента: запросов и идей, возврат на доработку, отклонение с обоснованием, публикация.
- Гость:
  - Просмотр публичной витрины и каталога запросов; для подачи идеи — регистрация/вход.

Дополнительные роли и интересы фиксируются в профиле при необходимости: работник_Мособлгаза, ментор, стейкхолдер, эксперт (в Ф1 активна только базовая пара ролей).

## 3. Таксономия направлений
- Единые направления: 1) Строительство; 2) Эксплуатация; 3) Безопасность; 4) Цифровизация; 5) Клиентский сервис; 6) Другое.
- Использование: обязательное поле для запроса и идеи; служит для фильтров, маршрутизации и аналитики.

## 4. Сущности и статусы
- Запрос на инновацию (инициирует стейкхолдер):
  - Поля: id, название, проблема/цель, критерии принятия, сроки сбора идей (дедлайн), владелец (стейкхолдер), направление, вложения (PDF/DOCX/XLSX ≤ 10 МБ), дата публикации, статус.
  - Статусы: Черновик → На сборе идей → Закрыт (автоматически по дедлайну или вручную).
- Идея (привязана к запросу):
  - Поля (минимум): id, заголовок (≤ 100 символов), краткое описание (≤ 1000 знаков), запрос‑связка, автор, направление (наследуется/может уточняться), ожидаемый эффект (свободный текст), вложения (PDF/DOCX/XLSX ≤ 10 МБ), даты, история модерации, статус.
  - Статусы и переходы:
    - Новая (черновик автора) → Отправлена на модерацию.
    - На уточнении (модерация) → Одобрена стейкхолдером | Возврат на доработку | Отклонена.
    - На доработке (автор) → Повторная отправка (лимит попыток: до 3 — финализировать на уровне политики; по умолчанию 1 доработка).
- Пользователь/Профиль: ФИО, организация/подразделение/должность (при наличии), контакты (телефон, e‑mail), дата рождения (опц.), роли пользователя, пароль (хранение по правилам платформы), фото (опц.).

## 5. Пользовательские сценарии
- Стейкхолдер:
  - Создать запрос → сохранить черновик → опубликовать «На сборе идей» → получать уведомления об идеях → просматривать/комментировать → «Принять» или «Отклонить» идею.
- Участник:
  - Зарегистрироваться/войти → открыть каталог запросов → выбрать запрос → подать идею (черновик → отправка) → отслеживать статус и отвечать на комментарии/замечания модерации.
- Модератор:
  - Просмотр очереди запросов/идей «на модерации» → проверка полноты/соответствия → публикация или возврат с замечаниями (история и комментарии обязательны).
- Гость:
  - Просмотр витрины и списка запросов (без возможности подачи идеи) → регистрация по желанию.

## 6. Интерфейсы и навигация
- Общий хедер: МЕДИАЦЕНТР, БАНК ИННОВАЦИЙ, КОНКУРС, ОБУЧЕНИЕ, ВОЙТИ/ПРОФИЛЬ (иконка аватара при авторизации).

- Главная страница (публичная витрина) — по макету 4.1:
  - Назначение: публичная витрина платформы.
  - Блоки и элементы:
    - Заголовок с описанием акселератора.
    - Информационные метрики (на макете присутствуют значения «40+», «15+»).
    - CTA-кнопки: «Смотреть запросы», «Участвовать в конкурсах».
    - Блок «Экосистема успеха»: карточки Партнерство, Продвижение, Сообщество, Финансирование (каждая — заголовок + краткий текст).
    - Блок «Как принять участие?» с 2 карточками и кнопками: «Стать частью команды», «Подать заявку».
    - «Наши партнеры» (логотипы).
    - Промо-блок с CTA «Стать участником».
  - Требования:
    - Все CTA ведут на соответствующие разделы (каталог идей, конкурсы, регистрация/вход).
    - Страницы, не реализованные в Ф1, открываются как заглушки (stub) с сообщением «Функциональность доступна в следующих фазах» и ссылкой «Вернуться на главную».

- Каталог запросов:
  - Верхняя панель: заголовок «Запросы на инновации», поиск по названию/описанию.
  - Фильтры-чипсы: Все / На сборе идей / Закрыт + «Сбросить».
  - Фильтр по направлению: Строительство / Эксплуатация / Безопасность / Цифровизация / Клиентский сервис / Другое.
  - Сортировка: По новизне / По дедлайну (возр./убыв.).
  - Карточка запроса:
    - Направление + статус-чип.
    - Название, краткое описание.
    - Дедлайн (если активен), владелец (ФИО/отдел).
    - Кнопка «Подробнее».

- Карточка запроса (страница):
  - Шапка: направление, статус-чип, заголовок, владелец (ФИО/подразделение).
  - Разделы: Проблема/цель, Критерии принятия идеи, Сроки (публикация, дедлайн), Вложения (список: имя, тип, размер).
  - Блок активности: счётчик «Подано идей: N».
  - Действия:
    - «Подать идею» — для авторизованных участников (скрыта при статусе «Закрыт»).
    - Для владельца (стейкхолдера): «Изменить» (в Черновике/На сборе идей), «Опубликовать» (из Черновика), «Закрыть сбор» (перевод в «Закрыт»), «Удалить» (только Черновик).

- Создание идеи (форма):
  - Поля: Заголовок*, Краткое описание* (≤ 1000), Ожидаемый эффект (опц.), Вложение(я) (PDF/DOCX/XLSX ≤ 10 МБ), Направление (наследуется из запроса; редактируемое опц.), Согласие на обработку ПДн* (чекбокс, если требуется).
  - Блок «Запрос»: название выбранного запроса (readonly) + ссылка «Открыть».
  - Кнопки: «Сохранить черновик», «Отправить», «Отмена».
  - Подсказки валидаций у полей.

- Карточка идеи (страница):
  - Шапка: направление, статус-чип («Черновик»/«На модерации»/«На рассмотрении»/«На доработке»/«Одобрена»/«Отклонена»), заголовок, привязка к запросу (ссылка), автор (ФИО).
  - Разделы: Описание, Ожидаемый эффект, Вложения (имя/тип/размер), История изменений (вехи статусов и комментарии модерации).
  - Комментарии: лента сообщений (автор/роль/время/текст), форма добавления комментария (участник, модератор, стейкхолдер).
  - Действия:
    - Автор: «Редактировать» (только «Черновик»/«На доработке»), «Отправить повторно» (из «На доработке»).
    - Модератор: «Опубликовать/Принять к рассмотрению», «Вернуть на доработку» (с причинами), «Отклонить» (с обоснованием).
    - Стейкхолдер: «Принять»/«Отклонить» (с комментарием; доступно после модерации).

- Личный кабинет (общий для участника и стейкхолдера):
  - Верхняя панель: заголовок «Личный кабинет», поиск по заявкам.
  - Табы: «Мои заявки» (активен) / «Профиль».
  - Вкладка «Мои заявки»:
    - Описание: единый список пользовательских сущностей, зависящий от роли.
    - Фильтры-чипсы (Идеи): Все / Черновики / На модерации / На доработке / На рассмотрении / Одобренные / Отклонённые + «Сбросить».
    - Фильтры-чипсы (Запросы стейкхолдера): Все / Черновики / На сборе идей / Закрыт + «Сбросить».
    - Переключатель «Тип»: Идеи / Запросы (отображается, если у пользователя есть оба типа).
    - Карточка элемента (Идея): направление + статус-чип; название, краткое описание; «Ваша роль: Автор»; кнопка «Подробнее»; для статусов «Черновик/На доработке» — «Редактировать».
    - Карточка элемента (Запрос): направление + статус-чип; название, краткое описание; «Ваша роль: Владелец запроса»; дедлайн (если активен); кнопки «Подробнее», «Изменить» (в Черновике/На сборе идей), «Закрыть сбор» (если активен).
  - Вкладка «Профиль»:
    - Шапка: аватар (загрузка), ФИО, организация/подразделение/должность, перечень активных ролей (например, работник_Мособлгаза, стейкхолдер), кнопка «Редактировать».
    - Контакты (read-only с возможностью редактирования): Дата рождения, Телефон, E‑mail.
    - Смена пароля: Текущий пароль, Новый пароль, Повтор нового пароля + «Сохранить».

- Панель модерации:
  - Верхняя панель: заголовок «Модерация», табы «Запросы» / «Идеи».
  - Фильтры-чипсы: На модерации / Возврат на доработку / Все + «Сбросить».
  - Список карточек: тип («Запрос/Идея»), заголовок, автор/владелец, дата поступления, статус, кнопка «Подробнее».
  - Карточка модерации: правая колонка с действиями («Опубликовать», «Вернуть на доработку», «Отклонить») и формой замечаний; левая — предпросмотр содержимого и вложений.

- Аутентификация/Регистрация:
  - Вход: поля E‑mail или телефон, Пароль; ссылка «Восстановить пароль»; кнопка «Войти».
  - Регистрация — шаг 1: Фамилия*, Имя*, Отчество (опц.), Телефон* (+7 маска), E‑mail*, Пароль* (≥8), Повтор пароля*; чекбокс согласий.
  - Регистрация — шаг 2 (ролевая анкета): радиокнопки роли (Работник МОГ / Представитель учебного заведения / Представитель бизнеса / Студент / Гость). В Ф1 специальные возможности даются для Участника и Стейкхолдера (остальные — как базовые пользователи).

## 7. Формы и валидации
- Общие: обязательные поля помечены *. Email — формат адреса. Телефон — маска +7. Пароль — ≥ 8 символов.
- Идея: заголовок (≤ 100), описание (≤ 1000), обязательная ссылка на запрос; вложения: PDF/DOCX/XLSX, до 10 МБ каждое; анти‑дубликаты (проверка по заголовку в рамках одного запроса).
- Запрос: обязательны название, проблема/цель, критерии, сроки, направление; вложения — те же правила файлов.

## 8. Данные и связи (логическая модель)
- Таблицы/коллекции:
  - Requests: id, title, problem, criteria, deadline, owner_id, direction, files[], status, created_at, published_at, closed_at.
  - Ideas: id, request_id, title, summary, direction, effect, files[], author_id, status, history[], comments[], attempts_count, created_at, submitted_at, decided_at.
  - Users: id, fio, org, dept, position, phone, email, dob, roles[], avatar_url, created_at, last_login.
  - Comments: id, entity_type, entity_id, author_id, body, created_at, visibility (public/moderation).
- Индексы: по `direction`, `status`, `deadline` (Requests), по `request_id`, `status`, `author_id` (Ideas).

## 9. Бизнес‑правила и автоматика
- Идеи можно подавать только для запросов в статусе «На сборе идей» и до дедлайна.
- После дедлайна запрос автоматически становится «Закрыт», кнопка «Подать идею» скрывается.
- Лимит доработок идеи: по умолчанию 1; может быть увеличен до 3 по финальному согласованию. История версий и замечаний обязательна.
- Анонимность для Ф1 не требуется; экспертиза с анонимизацией — начиная с Ф2 (при вводе роли «эксперт»).
- Все идеи/переходы фиксируются в истории (кто, когда, что изменил; комментарий).

## 10. Уведомления/события
- Создан новый запрос (стейкхолдер) — уведомление подписчикам/участникам (минимум: страница «Новое в запросах»; e‑mail — при наличии SMTP).
- Подача идеи — уведомление владельцу запроса и модераторам.
- Возврат на доработку — уведомление автору идеи с перечнем замечаний.
- Принятие/отклонение идеи — уведомление автору; фиксация идеи.
- Напоминание за N дней до дедлайна запросов (опц.).

## 11. Нефункциональные требования
- Производительность: ключевые страницы (каталоги/карточки/формы) — TTFB ≤ 1 с, полный рендер ≤ 2 с при средней нагрузке MVP.
- Безопасность: разграничение доступа по ролям; защита файлов и скрытых черновиков; хранение паролей по стандартам платформы; аудит действий в пределах Bitrix/приложения.
- Совместимость: последние 2 версии основных браузеров; адаптивная вёрстка ключевых страниц.

## 12. Ограничения и вне объёма Ф1
- Карточки внедрения, доски задач, роли трекер/ментор/эксперт, научные советы/ПК — вне Ф1.
- Сложная аналитика, публичные отчёты и дашборды — вне Ф1.
- Архивация карточек внедрения и событий/календарь — вне Ф1.

## 13. Критерии приёмки (чек‑лист)
- Роли:
  - Стейкхолдер может создать/опубликовать запрос; запрос виден в каталоге и на карточке.
  - Участник может подать идею на активный запрос; видит статусы и историю.
  - Модератор может модераровать запросы и идеи, возвращать на доработку, отклонять и публиковать; идеи и комментарии фиксируются.
- Навигация и страницы:
  - В хедере: «Банк инноваций», «Конкурсы», ссылки-заглушки «Медиасентр» и «Обучение», кнопка «Войти».
  - Главная/Банк инноваций (каталоги запросов и идей)/Карточка запроса/Создание идеи/Карточка идеи/ЛК участника/Панель модерации/Вход/Регистрация доступны и связаны кнопками «Подробнее/Подать идею/Сохранить/Отправить».
- Валидации/файлы: поля проверяются; файлы поддерживаются и ограничиваются по типу/размеру.
- Автоматика: закрытие запросов по дедлайну; скрытие кнопки подачи; уведомления по событиям.
- Поиск/фильтры: работают по направлению/статусу/поисковой строке; сортировки по новизне/дедлайну.

## 14. Миграции/инициализация (MVP)
- Создать справочник направлений (6 значений).
- Создать тестовые роли и пользователей (1 стейкхолдер, 1 модератор, 2 участника).
- Наполнить 3 тестовых запроса (2 активных, 1 закрыт) и 5 тестовых идей для демонстрации.

## 15. Дальнейшие шаги (связь с Ф2–Ф3)
- Ф2: преобразование принятой идеи в проект, карточка проекта, интеграция с задачами и шаблонами документов, роли трекер/ментор/эксперт.
- Ф3: события/расписание, расширенная аналитика/отчётность, уведомления и бренд‑адаптация интерфейсов.

---
Версии источников: docs/informika-extended-tz.md (расширенные требования) и docs/README.md (декомпозиция Ф1–Ф3). Документ предназначен для согласования объёма Ф1 и запуска реализации.

## 16. Глоссарий

| Термин | Определение |
|--------|-------------|
| Банк инноваций | Публичный каталог запросов и идей для Ф1. |
| Запрос | Публикация стейкхолдера с описанием потребности. |
| Идея | Ответ участника на запрос, проходящий модерацию и вердикт. |
| Проект | Идея, одобренная проектным комитетом и переведённая в архив. |
| Заявка | Обращение участника: подача идей, вступление в команду, смена роли. |
| Личный кабинет участника | Кастомный интерфейс Ф1 для работы с идеями и заявками. |
| CRM Bitrix | Стандартные интерфейсы для стейкхолдера и модератора. |
