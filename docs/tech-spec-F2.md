# Техническое задание — Фаза 2 (Informika)

## 1. Назначение и цели
- Обеспечить сопровождение одобренных идей до передачи на внешние комиссии (ПК/НТК).
- Предоставить кастомный личный кабинет стейкхолдера для контроля хода работ и принятия решений.
- Интегрировать контур задач, документов и командной коммуникации через Bitrix24 без дублирования функциональности в ядре портала.

## 2. Область охвата
### Включено
1. Персональный кабинет стейкхолдера с обзором одобренных идей (статусы, прогресс, риски).
2. Переход от статуса «Одобрена» к рабочему пространству Bitrix24 (задачи, документы, коммуникации).
3. Управление командой идеи: назначение обязательных ролей, контроль заявок, доступ к Bitrix24.
4. Базовая отчётность по статусам задач и активности команды (через Bitrix24, ссылка из портала).
5. Расширенные уведомления и автоматизации для этапов Фазы 2 (см. [automation-table.md](automation-table.md), [notification-table.md](notification-table.md)).
6. Актуализация матрицы доступа и статусов (см. [access-matrix.md](access-matrix.md), [statuses-table.md](statuses-table.md)).

### Исключено
- Полная кастомизация интерфейсов Bitrix24 (используются штатные компоненты).
- Не реализуем в Ф2: полноценные отчёты в портале, кастомные отчёты Bitrix24 и любые внешние BI-витрины (используются только стандартные отчёты Bitrix24 и ссылки на них).

## 3. Роли и права
| Роль | Основные действия в Ф2 |
|------|-----------------------|
| Стейкхолдер | Просмотр портфеля одобренных идей, просмотр отчётов, запуск решений (ПК/НТК), комментарии. |
| Координатор | Настройка доступа к Bitrix24, контроль статусов задач, обработка заявок в команду, формирование отчётов. |
| Автор идеи / участник | Работа с командой, доступ к задачам и документам через Bitrix24, ответы на уведомления. |
| Модератор | Мониторинг корректности данных, контроль переходов статусов, эскалации. |
| Эксперт / Ментор / Трекер | Подключение к задачам Bitrix24 по назначению, предоставление обратной связи. |

## 4. Жизненный цикл и статусы
- Используются статусы из [statuses-table.md](statuses-table.md) (идея, запрос, заявка, задача Bitrix24).
- Переход «Одобрена → Архив» инициируется после завершения работ и подготовки пакета документов для ПК/НТК.
- Статус «Архив» фиксирует превращение идеи в проект вне платформы.

## 5. Функциональные блоки
### 5.1 Кабинет стейкхолдера

Подробные интерфейсы описаны в [interface-elements.md](interface-elements.md). Для Фазы 2 требуется:
- обеспечить модерацию запросов и идей через вкладку «Мои запросы» с обязательной фиксацией причины при возврате;
- предоставить стейкхолдеру быстрый переход к связанным задачам Bitrix24 и к административной доске (см. [admin-board-table.md](admin-board-table.md));
- фиксировать все решения (одобрение, отклонение, доработка) в журнале идеи и инициировать соответствующие автоматизации;
- отображать индикатор «Новые идеи» на карточках запроса (бейдж «+N» в личном кабинете стейкхолдера, снимается после просмотра карточки);
- в портфеле одобренных идей визуализировать стадии «Одобрена», «Готово к ПК» и «Готово к НТК» (цветовые бейджи) и обеспечивать быстрые переходы к задачам/документам/канбану идеи.

### 5.2 Управление командой
- Отображение заявок в команду с действиями «Принять», «Отклонить», «Запросить уточнение» (аналогично Ф1, но с авторизацией в Bitrix24).
- Контроль обязательных ролей: предупреждения при пустых слотах, ссылки на Bitrix24 для назначения задач.
- Логирование действий (принятие/исключение участника, перевод идеи на доработку с причиной) с выводом в разделе «История».

### 5.2.1 CRM координатора
- Раздел «Команды идей»: табличный список идей в статусе «Одобрена», фильтры по направлению, стадии, незаполненным ролям, активным заявкам.
- Карточка идеи в CRM:
  - вкладка «Команда» — текущий состав, отметки обязательных ролей;
  - вкладка «Кандидаты» — список пользователей (контакты, компетенции, история участия);
  - вкладка «Журнал» — приглашения, решения координатора, комментарии.
- Действия координатора:
  1. «Пригласить в команду» — выбор пользователя/роли → приглашение → пользователь видит заявку в ЛК.
  2. «Принять/Отклонить/Уточнить» входящую заявку участника (при самостоятельном отклике из каталога).
  3. «Закрепить обязательную роль» — отметка заполнения ключевых ролей, автоматические напоминания.
- Интеграция: все операции создают/обновляют задачи на административной канбан-доске.\n\n### 5.3 Интеграция с Bitrix24
- При статусе идеи «Одобрена» автоматически создаётся рабочая область: папки на Диске, шаблонные карточки и документы (см. [automation-table.md](automation-table.md) и [team-templates.md](team-templates.md)), чат.
- В портале отображаются ссылки на рабочую область; авторизация проходит через единый аккаунт (SSO или отдельные учётные данные — решение инфраструктуры).
- Просроченные задачи подсвечиваются на карточке идеи (данные забираются из Bitrix API).

### 5.4 Отчётность и аналитика
- В карточке стейкхолдера доступна кнопка «Открыть отчёты» (ведёт на стандартные отчёты Bitrix24 с преднастроенными фильтрами).
- В портале отображаются агрегированные показатели: количество активных задач, просроченных задач, процент выполнения чек-листов.
- Экспорт CSV/Excel из Bitrix24 (по ссылке) для последующей загрузки в корпоративные системы.

### 5.5 Уведомления и автоматизации
- Используются сценарии из 
otification-table.md` и `automation-table.md` (разделы «Фаза 2»). Ключевые триггеры:
  - Создание рабочей области после «Одобрена».
  - Изменения статуса идеи (Например, «Готово к ПК», «Архив»).
  - Исключение обязательной роли из команды.
  - Просрочка задач Bitrix24.

### 5.6 Доступ и безопасность
- Права доступа описаны в `access-matrix.md`.
- Переходы статусов фиксируются в журнале и доступны модератору.
- Все ссылки на Bitrix24 передают токен/сессию согласно корпоративной политике.

## 6. Пользовательские сценарии
### Стейкхолдер
1. Открывает вкладку «Мои запросы» → отслеживает новые идеи и комментарии.
2. В карточке запроса принимает решение по идее (Одобрить / Отклонить / Отправить на доработку с обязательной причиной).
3. Одобренная идея автоматически появляется во вкладке «Портфель одобренных идей» → стейкхолдер при необходимости переходит к задачам/документам/отчётам.
4. На стадии «Готово к ПК/НТК» инициирует уведомления команде (см. Уведомления (см. раздел «Уведомления»)).

### Координатор
1. Получает уведомление о статусе «Одобрена» → заходит в карточку → проверяет состав команды.
2. При необходимости инициирует назначение ролей → система верифицирует обязательные слоты.
3. Отслеживает просроченные задачи на базе Bitrix24 и эскалирует стейкхолдеру.

### Участник
1. Получает приглашение в команду → подтверждает участие → получает ссылку на рабочее пространство Bitrix24.
2. Работает с задачами и документами (внешний интерфейс Bitrix24) → комментарии дублируются в истории идеи.

## 7. UI/UX требования
- Навигация и элементы базируются на описании в [interface-elements.md](interface-elements.md) (разделы «ЛК стейкхолдера», «Bitrix24», «Уведомления»).
- Все кнопки, приводящие к Bitrix24, визуально помечены и открываются в новой вкладке.
- Заглушки «Медиасентр» и «Обучение» остаются без изменений (функциональность Ф3).

## 8. Данные и интеграции
- Дополняются сущности «Проект» и «Профиль» согласно §10 [informika-extended-tz.md](informika-extended-tz.md).
- Интеграция с Bitrix24 выполняется через REST API (чтение статусов задач, чек-листов, метрики активности).
- Логи действий (принятие роли, перевод статуса) сохраняются в базе портала и синхронизируются с Bitrix-таймлайном при наличии интеграции.

## 9. Приёмочные критерии
1. Перевод идеи в «Одобрена» автоматически создаёт область в Bitrix24 и отправляет уведомления (см. [automation-table.md](automation-table.md)).
2. Кабинет стейкхолдера отображает актуальные статусы задач и состав команды.
3. Перевод идеи «На доработку» требует заполнения причины и отображается в журнале; уведомления отправляются автору и координатору.
4. Любой переход статуса (включая «Архив») фиксируется и уведомляет заинтересованных лиц.
5. Нет дублирования функциональности задач/документов на портале — все операции происходят в Bitrix24.
6. Матрица доступа соблюдается: участник без приглашения не может открыть карточку одобренной идеи.

## 10. Зависимости и предпосылки
- Должны быть настроены рабочие пространства Bitrix24 и учетные записи для всех ролей.
- API Bitrix24 доступно для чтения данных о задачах и документах.
- Наличие инфраструктуры уведомлений (e-mail, push, внутренняя шина) из Ф1.

## 11. Ссылки на дополнительные документы
- Расширенное ТЗ: [informika-extended-tz.md](informika-extended-tz.md)
- ТЗ Фазы 1: [tech-spec-F1.md](tech-spec-F1.md)
- Матрица доступа: [access-matrix.md](access-matrix.md)
- Таблица автоматизаций: [automation-table.md](automation-table.md)
- Таблица уведомлений: [notification-table.md](notification-table.md)
- Таблица статусов сущностей: [statuses-table.md](statuses-table.md)
- Таблица отчётности по ролям: [report-table.md](report-table.md)
- Чек-листы по ролям: [role-checklists.md](role-checklists.md)
- Журналы событий: [journal-events.md](journal-events.md)
- Бизнес-процессы: [business-processes.md](business-processes.md)
- Административная канбан-доска (таблица задач): [admin-board-table.md](admin-board-table.md)
- Описание интерфейсов: [interface-elements.md](interface-elements.md)
- Шаблоны задач и документов команды: [team-templates.md](team-templates.md)
- Комплексный пакет Фазы 2: [tech-spec-F2-full.md](tech-spec-F2-full.md)
- Отчёт Фазы 1: [reports/phase1-summary.md](reports/phase1-summary.md)


### 5.7 Административная канбан-доска
- Единое пространство задач Bitrix24 для модератора, координатора и стейкхолдера.
- Колонки: Новая → В работе → Ожидает данных → На согласовании → Готово.
- Типы задач (создаются триггерами и вручную):
  - Модерация (премодерация идей и запросов, контроль доработок);
  - Контроль бизнес-процессов (проверка дедлайнов, подготовка к ПК/НТК, сбор отчётности);
  - Формирование команд (назначение ролей, обработка заявок, эскалации по пустым слотам);
  - Решения стейкхолдера (обработка идей по запросам, согласование документов, финальные решения).
- Каждая роль видит только свои задачи; координатор может просматривать задачи модератора для эскалаций.
- Карточка задачи содержит ссылку на связанную сущность, чек-листы и журнал действий.

















